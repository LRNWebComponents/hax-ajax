<link rel="import" href="../polymer/polymer.html">

<!--
`hax-ajax`
A LRN element

@demo demo/index.html
-->

<dom-module id="hax-ajax">
  <template>
    <style>
      :host {
      }
    </style>
    <content></content>
    <iron-ajax
      id="haxajax"
      url="[[url]]"
      params=""
      handle-as="json"
      on-response="haxAjaxResponse"
      ></iron-ajax>
  </template>

  <script>
    Polymer({
      is: 'hax-ajax',
      properties: {
        /**
         * The url endpoint to save operations once noticed.
         */
        url: {
          type: String
        },
        /**
         * If hax should be hidden or not.
         */
        hideHax: {
          type: Boolean,
          value: false,
        }
      },
      listeners: {
        'haxAction': '_triggerHaxSave',
      },
      /**
       * Handle a save event bubbling up from
       * some place down below in the DOM.
       */
      _triggerHaxSave: function(e) {
        if (e.detail.action == 'save') {
          let root = this;
          console.log(e.detail);
          console.log(root.$$('#haxajax'));
          root.$$('#haxajax').params = e.detail.properties;
          // trigger it to run
          root.$$('#haxajax').generateRequest();
        }
      },
      haxAjaxResponse: function(e) {
        console.log('handle ajax response');
        console.log(e);
      },
    });
  </script>
</dom-module>
